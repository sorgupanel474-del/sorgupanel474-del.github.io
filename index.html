<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Neon Pack Arena</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;touch-action:none}
body{background:linear-gradient(#001a2e,#000);overflow:hidden;font-family:Arial}

.neon{
  color:#00eaff;
  text-shadow:0 0 10px #00eaff,0 0 20px #00eaff;
  text-align:center
}

/* MENÜ */
#menu{
  position:absolute;inset:0;
  display:flex;flex-direction:column;
  justify-content:center;align-items:center;
  gap:20px;background:#000;z-index:10
}
button{
  padding:14px 30px;font-size:18px;
  border:none;border-radius:10px;
  background:#00eaff
}

/* OYUN */
#game{width:100vw;height:100vh;position:relative}

/* HUD */
#hud{position:absolute;top:10px;left:10px;right:10px;display:flex;gap:10px}
#hpWrap{flex:1;height:14px;border:2px solid #00eaff;border-radius:10px}
#hp{height:100%;width:100%;background:#00eaff;border-radius:8px}

/* KARAKTERLER */
.player{width:22px;height:40px;background:#fff;border-radius:6px;position:absolute}
.enemy{width:20px;height:36px;background:#ff5555;border-radius:6px;position:absolute}
.boss{width:42px;height:60px;background:#a020f0;border-radius:10px;position:absolute}

/* MERMİLER */
.bullet{width:6px;height:6px;background:#00eaff;border-radius:50%;position:absolute}
.ebullet{width:6px;height:6px;background:#ffb3b3;border-radius:50%;position:absolute}

/* JOYSTICK */
#joy{position:absolute;left:20px;bottom:20px;width:120px;height:120px;border:2px solid #00eaff;border-radius:50%}
#stick{position:absolute;left:40px;top:40px;width:40px;height:40px;background:#00eaff;border-radius:50%}

/* LEVEL YAZISI */
#levelText{
  position:absolute;top:40%;left:0;right:0;
  font-size:48px;opacity:0;pointer-events:none
}
.show{animation:fade 2s}
@keyframes fade{0%{opacity:0}20%{opacity:1}80%{opacity:1}100%{opacity:0}}
</style>
</head>

<body>

<!-- LEVEL SEÇİM -->
<div id="menu">
  <h1 class="neon">OYUNUNA HOŞGELDİNİZ</h1>
  <h2 class="neon">LEVEL SEÇ</h2>
  <button onclick="start(1)">LEVEL 1</button>
  <button onclick="start(2)">LEVEL 2</button>
</div>

<!-- OYUN -->
<div id="game">
  <div id="hud">
    <div class="neon">HP</div>
    <div id="hpWrap"><div id="hp"></div></div>
  </div>

  <div id="joy"><div id="stick"></div></div>
  <div id="levelText" class="neon"></div>
</div>

<!-- MANIFEST AMATÖR -->
<audio id="bgm" loop>
  <source src="manifest.mp3" type="audio/mpeg">
</audio>

<script>
const game=document.getElementById("game");
const menu=document.getElementById("menu");
const hpBar=document.getElementById("hp");
const levelText=document.getElementById("levelText");
const bgm=document.getElementById("bgm");

let level=1;
let player,px,py;
let playerHP=120,maxHP=120;
let bullets=[],ebullets=[],enemies=[],boss=null;
let firing=false;

// BAŞLAT
function start(lv){
  level=lv;
  menu.style.display="none";
  bgm.volume=0.4;
  bgm.play();
  spawnPlayer();
  spawnEnemies();
  requestAnimationFrame(loop);
}

// PLAYER
function spawnPlayer(){
  player=document.createElement("div");
  player.className="player";
  px=innerWidth/2; py=innerHeight/2;
  player.style.left=px+"px"; player.style.top=py+"px";
  game.appendChild(player);
}

// ENEMY
function spawnEnemies(){
  enemies=[];
  let count = level===1 ? 3 : 5;
  for(let i=0;i<count;i++){
    let e=document.createElement("div");
    e.className="enemy";
    e.x=Math.random()*(innerWidth-40);
    e.y=Math.random()*(innerHeight-80);
    e.hp=200;
    e.speed= level===1 ? 1.2 : 1.6;
    e.cd=0;
    game.appendChild(e);
    enemies.push(e);
  }
}

function spawnBoss(){
  boss=document.createElement("div");
  boss.className="boss";
  boss.x=100; boss.y=100;
  boss.hp=400;
  boss.speed=1.8;
  boss.cd=0;
  game.appendChild(boss);
}

// ATIŞ
setInterval(()=>{
  if(!firing) return;
  let b=document.createElement("div");
  b.className="bullet";
  b.x=px+10; b.y=py+10;
  game.appendChild(b);
  bullets.push(b);
},180);

document.body.addEventListener("touchstart",()=>firing=true);
document.body.addEventListener("touchend",()=>firing=false);

// JOYSTICK
const joy=document.getElementById("joy");
const stick=document.getElementById("stick");
let jx=0,jy=0;

joy.addEventListener("touchmove",e=>{
  const r=joy.getBoundingClientRect();
  const t=e.touches[0];
  jx=t.clientX-r.left-60;
  jy=t.clientY-r.top-60;
  stick.style.left=40+jx*0.4+"px";
  stick.style.top=40+jy*0.4+"px";
});
joy.addEventListener("touchend",()=>{
  jx=jy=0;
  stick.style.left="40px";
  stick.style.top="40px";
});

// YARDIMCI
function hit(ax,ay,bx,by,d){return Math.hypot(ax-bx,ay-by)<d}
function updateHP(){hpBar.style.width=(playerHP/maxHP*100)+"%"}

function enemyShoot(x,y){
  let b=document.createElement("div");
  b.className="ebullet";
  b.x=x; b.y=y;
  let dx=px-x, dy=py-y;
  let d=Math.hypot(dx,dy)||1;
  b.vx=dx/d*4; b.vy=dy/d*4;
  game.appendChild(b);
  ebullets.push(b);
}

// LOOP
function loop(){
  // hareket
  px+=jx*0.06; py+=jy*0.06;
  player.style.left=px+"px";
  player.style.top=py+"px";

  // oyuncu mermileri
  bullets=bullets.filter(b=>{
    b.y-=7;
    b.style.left=b.x+"px"; b.style.top=b.y+"px";
    enemies.forEach((e,i)=>{
      if(hit(b.x,b.y,e.x,e.y,22)){
        e.hp-=50;
        b.remove(); bullets=[];
        if(e.hp<=0){e.remove(); enemies.splice(i,1);}
      }
    });
    if(boss && hit(b.x,b.y,boss.x,boss.y,32)){
      boss.hp-=50;
      b.remove(); bullets=[];
    }
    return b.y>0;
  });

  // enemy
  enemies.forEach(e=>{
    let dx=px-e.x, dy=py-e.y;
    let d=Math.hypot(dx,dy)||1;
    e.x+=dx/d*e.speed;
    e.y+=dy/d*e.speed;
    e.style.left=e.x+"px"; e.style.top=e.y+"px";
    e.cd--;
    if(e.cd<=0){enemyShoot(e.x+10,e.y+10); e.cd=40;}
  });

  if(enemies.length===0 && !boss){
    levelText.textContent="LEVEL 2";
    levelText.classList.add("show");
    setTimeout(()=>levelText.classList.remove("show"),2000);
    spawnBoss();
  }

  // boss
  if(boss){
    let dx=px-boss.x, dy=py-boss.y;
    let d=Math.hypot(dx,dy)||1;
    boss.x+=dx/d*boss.speed;
    boss.y+=dy/d*boss.speed;
    boss.style.left=boss.x+"px";
    boss.style.top=boss.y+"px";
    boss.cd--;
    if(boss.cd<=0){enemyShoot(boss.x+20,boss.y+20); boss.cd=30;}
    if(boss.hp<=0){boss.remove(); boss=null;}
  }

  // enemy mermileri
  ebullets=ebullets.filter(b=>{
    b.x+=b.vx; b.y+=b.vy;
    b.style.left=b.x+"px"; b.style.top=b.y+"px";
    if(hit(b.x,b.y,px,py,18)){
      playerHP-=boss?100:80;
      updateHP();
      b.remove(); return false;
    }
    return b.x>0&&b.y>0&&b.x<innerWidth&&b.y<innerHeight;
  });

  if(playerHP<=0){alert("ÖLDÜN"); location.reload();}
  updateHP();
  requestAnimationFrame(loop);
}
</script>
</body>
</html>